<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Customer Status Tracker</title>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="app-container">
    <!-- Side Navigation -->
    <nav class="side-nav" id="sideNav">
      <div class="side-nav__header">
        <div class="side-nav__logo">CS</div>
        <span class="side-nav__title">CS Tracker</span>
      </div>
      <ul class="side-nav__items">
        <li class="side-nav__item">
          <a href="index.html" class="side-nav__link active">
            <svg viewBox="0 0 32 32"><path d="M16 2L2 12v18h10V18h8v12h10V12L16 2zm12 26h-6V16H10v12H4V13.21l12-9 12 9V28z"/></svg>
            <span>Dashboard</span>
          </a>
        </li>
        <li class="side-nav__item">
          <a href="customers.html" class="side-nav__link">
            <svg viewBox="0 0 32 32"><path d="M28 10h-6V6c0-1.1-.9-2-2-2h-8c-1.1 0-2 .9-2 2v4H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h24c1.1 0 2-.9 2-2V12c0-1.1-.9-2-2-2zM12 6h8v4h-8V6zm16 20H4V12h24v14z"/></svg>
            <span>Customers</span>
          </a>
        </li>
        <li class="side-nav__item">
          <a href="tasks.html" class="side-nav__link">
            <svg viewBox="0 0 32 32"><path d="M14 21.5l-5-4.96L7.59 18 14 24.35 25.41 13 24 11.59 14 21.5z"/><path d="M16 2C8.27 2 2 8.27 2 16s6.27 14 14 14 14-6.27 14-14S23.73 2 16 2zm0 26C9.38 28 4 22.62 4 16S9.38 4 16 4s12 5.38 12 12-5.38 12-12 12z"/></svg>
            <span>Tasks</span>
          </a>
        </li>
        <li class="side-nav__divider"></li>
        <li class="side-nav__item">
          <a href="reports.html" class="side-nav__link">
            <svg viewBox="0 0 32 32"><path d="M10 18H6v8h4v-8zm12-8h-4v16h4V10zm-6 6h-4v10h4V16z"/></svg>
            <span>Reports</span>
          </a>
        </li>
        <li class="side-nav__item">
          <a href="admin.html" class="side-nav__link">
            <svg viewBox="0 0 32 32"><path d="M27 16.76V16v-.77l1.92-1.68a2 2 0 00.4-2.4l-2-3.46a2 2 0 00-1.94-1 2 2 0 00-.64.1l-2.43.82a11.35 11.35 0 00-1.31-.75l-.51-2.52a2 2 0 00-2-1.61h-4a2 2 0 00-2 1.61l-.51 2.52a11.48 11.48 0 00-1.32.75l-2.38-.86a2 2 0 00-.68-.09 2 2 0 00-1.72 1l-2 3.46a2 2 0 00.4 2.4l1.92 1.68V16v.77l-1.92 1.68a2 2 0 00-.4 2.4l2 3.46a2 2 0 00 1.72 1 2 2 0 00.68-.09l2.42-.82a11.35 11.35 0 001.31.75l.51 2.52a2 2 0 002 1.61h4a2 2 0 002-1.61l.51-2.52a11.48 11.48 0 001.32-.75l2.42.82a2 2 0 00.64.09 2 2 0 001.72-1l2-3.46a2 2 0 00-.4-2.4zM16 22a6 6 0 116-6 6 6 0 01-6 6z"/></svg>
            <span>Admin</span>
          </a>
        </li>
      </ul>
      <button class="side-nav__toggle" id="navToggleBtn" title="Collapse menu">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="11 17 6 12 11 7"></polyline>
          <polyline points="18 17 13 12 18 7"></polyline>
        </svg>
        <span class="side-nav__toggle-text">Collapse</span>
      </button>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header__left">
          <button class="hamburger" onclick="toggleNav()">
            <span></span>
            <span></span>
            <span></span>
          </button>
          <div>
            <h1 class="header__title">Portfolio Dashboard</h1>
            <p class="header__subtitle">Welcome back, <span class="user-first-name">Corby</span></p>
          </div>
        </div>
        <div class="header__right">
          <div class="search">
            <svg class="search__icon" width="16" height="16" viewBox="0 0 32 32"><path d="M29 27.59l-7.55-7.55A11 11 0 1020 21.46L27.59 29zM4 13a9 9 0 119 9 9 9 0 01-9-9z"/></svg>
            <input type="text" class="search__input" placeholder="Search customers...">
          </div>
          <button class="btn btn--ghost btn--icon">
            <svg width="20" height="20" viewBox="0 0 32 32"><path d="M28.7 20.3L26 17.6V13a10 10 0 00-9-9.95V1h-2v2.05A10 10 0 006 13v4.6l-2.7 2.7a1 1 0 00-.3.7v3a1 1 0 001 1h7a5 5 0 0010 0h7a1 1 0 001-1v-3a1 1 0 00-.3-.7zM16 28a3 3 0 01-3-3h6a3 3 0 01-3 3zm11-5H5v-1.59l2.7-2.7A1 1 0 008 18v-5a8 8 0 0116 0v5a1 1 0 00.3.7l2.7 2.7z"/></svg>
          </button>
          <div class="user-menu">
            <div class="avatar user-avatar">CJ</div>
            <span class="user-menu__name user-name">Corby James</span>
          </div>
        </div>
      </header>

      <!-- Page Content -->
      <div class="page-content">
        <!-- KPI Metrics -->
        <div class="grid grid--4 mb-5">
          <div class="metric-card">
            <div class="metric-card__label">Total Customers</div>
            <div class="metric-card__value">18</div>
            <div class="metric-card__trend metric-card__trend--up">+2 this month</div>
          </div>
          <div class="metric-card">
            <div class="metric-card__label">Total ARR</div>
            <div class="metric-card__value">$4.2M</div>
            <div class="metric-card__trend metric-card__trend--up">+12% YoY</div>
          </div>
          <div class="metric-card">
            <div class="metric-card__label">At Risk ARR</div>
            <div class="metric-card__value">$520K</div>
            <div class="metric-card__trend metric-card__trend--down">3 customers</div>
          </div>
          <div class="metric-card">
            <div class="metric-card__label">Renewals (90 days)</div>
            <div class="metric-card__value">6</div>
            <div class="metric-card__trend">$1.1M ARR</div>
          </div>
        </div>

        <div class="grid grid--3">
          <!-- Health Distribution -->
          <div class="card">
            <div class="card__header">
              <h2 class="card__title">Health Distribution</h2>
            </div>
            <div class="flex gap-5" style="align-items: center;">
              <div class="donut-chart" style="background: conic-gradient(var(--health-green) 0deg 200deg, var(--health-yellow) 200deg 280deg, var(--health-red) 280deg 360deg);">
                <div class="donut-chart__center" style="background: white; width: 120px; height: 120px; border-radius: 50%;">
                  <div class="donut-chart__value">18</div>
                  <div class="donut-chart__label">Customers</div>
                </div>
              </div>
              <div class="legend">
                <div class="legend__item">
                  <div class="legend__color legend__color--green"></div>
                  <span>Healthy (10)</span>
                </div>
                <div class="legend__item">
                  <div class="legend__color legend__color--yellow"></div>
                  <span>At Risk (5)</span>
                </div>
                <div class="legend__item">
                  <div class="legend__color legend__color--red"></div>
                  <span>Critical (3)</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Upcoming Renewals -->
          <div class="card" id="renewals-card">
            <div class="card__header">
              <h2 class="card__title">Upcoming Renewals</h2>
              <a href="customers.html?filter=renewals" class="btn btn--ghost">View All</a>
            </div>
            <div class="flex flex-column gap-3">
              <div class="flex flex-between flex-center" style="padding: 8px 0; border-bottom: 1px solid var(--cds-border-subtle-01);">
                <div>
                  <div style="font-weight: 500;">Acme Corporation</div>
                  <div class="text-secondary" style="font-size: 12px;">$450K ARR</div>
                </div>
                <div class="text-right">
                  <div class="health-badge health-badge--green">Healthy</div>
                  <div class="text-secondary mt-1" style="font-size: 12px;">15 days</div>
                </div>
              </div>
              <div class="flex flex-between flex-center" style="padding: 8px 0; border-bottom: 1px solid var(--cds-border-subtle-01);">
                <div>
                  <div style="font-weight: 500;">TechStart Inc</div>
                  <div class="text-secondary" style="font-size: 12px;">$180K ARR</div>
                </div>
                <div class="text-right">
                  <div class="health-badge health-badge--yellow">At Risk</div>
                  <div class="text-secondary mt-1" style="font-size: 12px;">28 days</div>
                </div>
              </div>
              <div class="flex flex-between flex-center" style="padding: 8px 0; border-bottom: 1px solid var(--cds-border-subtle-01);">
                <div>
                  <div style="font-weight: 500;">Global Systems</div>
                  <div class="text-secondary" style="font-size: 12px;">$320K ARR</div>
                </div>
                <div class="text-right">
                  <div class="health-badge health-badge--green">Healthy</div>
                  <div class="text-secondary mt-1" style="font-size: 12px;">45 days</div>
                </div>
              </div>
            </div>
          </div>

          <!-- My Tasks -->
          <div class="card" id="tasks-card">
            <div class="card__header">
              <h2 class="card__title">My Tasks</h2>
              <a href="tasks.html" class="btn btn--ghost">View All</a>
            </div>
            <div class="flex flex-column gap-3" id="tasks-list">
              <div class="text-secondary" style="padding: 16px; text-align: center;">Loading tasks...</div>
            </div>
          </div>
        </div>

        <!-- Risk Alerts & Recent Activity -->
        <div class="grid grid--2 mt-5">
          <!-- Risk Alerts -->
          <div class="card" id="risk-alerts-card">
            <div class="card__header">
              <h2 class="card__title">Risk Alerts</h2>
              <span class="tag tag--red" id="risk-alerts-count" style="display: none;">0</span>
            </div>
            <div class="flex flex-column gap-3" id="risk-alerts-list">
              <div class="text-secondary" style="padding: 16px; text-align: center;">Loading risks...</div>
            </div>
          </div>

          <!-- Recent Activity -->
          <div class="card">
            <div class="card__header">
              <h2 class="card__title">Recent Activity</h2>
            </div>
            <div class="timeline">
              <div class="timeline__item">
                <div class="timeline__date">Today, 10:30 AM</div>
                <div class="timeline__content">
                  <strong>Partner Status Report</strong> submitted for Global Systems by Cprime
                </div>
              </div>
              <div class="timeline__item">
                <div class="timeline__date">Today, 9:15 AM</div>
                <div class="timeline__content">
                  <strong>Task Completed:</strong> QBR presentation for Acme Corporation
                </div>
              </div>
              <div class="timeline__item">
                <div class="timeline__date">Yesterday, 4:45 PM</div>
                <div class="timeline__content">
                  <strong>Health Score Changed:</strong> TechStart Inc moved from Yellow to Red
                </div>
              </div>
              <div class="timeline__item">
                <div class="timeline__date">Yesterday, 2:00 PM</div>
                <div class="timeline__content">
                  <strong>Engagement Logged:</strong> Call with Apex Ltd about expansion
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Mobile Bottom Navigation -->
    <nav class="bottom-nav">
      <ul class="bottom-nav__items">
        <li>
          <a href="index.html" class="bottom-nav__link active">
            <svg viewBox="0 0 32 32"><path d="M16 2L2 12v18h10V18h8v12h10V12L16 2z"/></svg>
            Home
          </a>
        </li>
        <li>
          <a href="customers.html" class="bottom-nav__link">
            <svg viewBox="0 0 32 32"><path d="M28 10h-6V6c0-1.1-.9-2-2-2h-8c-1.1 0-2 .9-2 2v4H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h24c1.1 0 2-.9 2-2V12c0-1.1-.9-2-2-2z"/></svg>
            Customers
          </a>
        </li>
        <li>
          <a href="#" class="bottom-nav__link" onclick="openQuickAdd()">
            <svg viewBox="0 0 32 32"><path d="M17 15V7h-2v8H7v2h8v8h2v-8h8v-2h-8z"/></svg>
            Add
          </a>
        </li>
        <li>
          <a href="tasks.html" class="bottom-nav__link">
            <svg viewBox="0 0 32 32"><path d="M14 21.5l-5-4.96L7.59 18 14 24.35 25.41 13 24 11.59 14 21.5z"/><path d="M16 2C8.27 2 2 8.27 2 16s6.27 14 14 14 14-6.27 14-14S23.73 2 16 2zm0 26C9.38 28 4 22.62 4 16S9.38 4 16 4s12 5.38 12 12-5.38 12-12 12z"/></svg>
            Tasks
          </a>
        </li>
        <li>
          <a href="#" class="bottom-nav__link">
            <svg viewBox="0 0 32 32"><path d="M4 6h24v2H4zm0 9h24v2H4zm0 9h24v2H4z"/></svg>
            More
          </a>
        </li>
      </ul>
    </nav>

    <!-- FAB for mobile -->
    <button class="fab" onclick="openQuickAdd()">
      <svg width="24" height="24" viewBox="0 0 32 32" fill="white"><path d="M17 15V7h-2v8H7v2h8v8h2v-8h8v-2h-8z"/></svg>
    </button>
  </div>

  <!-- API and Dashboard Scripts -->
  <script src="js/auth.js?v=2"></script>
  <script src="js/api.js?v=11"></script>
  <script src="js/dashboard.js?v=5"></script>
  <script>
    function toggleNav() {
      document.getElementById('sideNav').classList.toggle('open');
    }

    function openQuickAdd() {
      alert('Quick Add menu would open here');
    }

    // Nav collapse functionality
    document.addEventListener('DOMContentLoaded', function() {
      const sideNav = document.getElementById('sideNav');
      const toggleBtn = document.getElementById('navToggleBtn');

      // Restore collapsed state from localStorage
      if (localStorage.getItem('navCollapsed') === 'true') {
        sideNav.classList.add('collapsed');
      }

      // Toggle collapse on button click
      if (toggleBtn) {
        toggleBtn.addEventListener('click', function() {
          sideNav.classList.toggle('collapsed');
          localStorage.setItem('navCollapsed', sideNav.classList.contains('collapsed'));
        });
      }
    });
  </script>
</body>
</html>
